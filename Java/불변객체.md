# 불변 객체(Immutable Object)

**불변 객체(Immutable Object)** 는 **생성 이후 상태가 변경되지 않는 객체**를 의미한다. 불변 객체는 내부 상태가 생성된 후 **절대 수정되지 않으며**, 이를 통해 **안정성**과 **일관성**을 보장한다. 특히, 멀티스레드 환경에서 **동기화 문제**를 방지할 수 있어 유용하다.

## **불변 객체의 특징**

- **상태 변경 불가**: 한 번 생성된 객체의 상태는 **절대 변경되지 않음**.
- **멀티스레딩에 안전**: 여러 스레드에서 동시에 접근하더라도 **상태가 변하지 않아 동기화가 필요 없음**.
- **캡슐화 강화**: 외부에서 객체의 **내부 상태를 변경할 수 없도록 캡슐화**가 강화된다.

## **불변 객체의 장점**

1. **안전한 공유**: 객체를 여러 스레드나 코드에서 공유해도 **상태가 변하지 않으므로 안전**하게 사용할 수 있다.
2. **예측 가능성**: 객체의 상태가 **변하지 않으므로 예측이 가능**하며, 복잡한 로직에서도 안전성을 보장할 수 있다.
3. **방어적 복사 불필요**: 외부에 객체를 전달할 때 **방어적 복사가 필요 없다**, 왜냐하면 **상태가 불변**이기 때문이다.

## **불변 객체의 단점**

1. **새로운 객체 생성 오버헤드**: 상태가 변경될 때마다 **새로운 객체를 생성**해야 하므로 **메모리**와 **성능 비용**이 발생할 수 있다.
2. **코드의 복잡성 증가**: 객체 상태 변경 시 **새로운 객체를 생성**해야 하므로 코드의 복잡성이 높아질 수 있다.

## **자바에서 불변 객체 만드는 방법**

불변 객체를 만들기 위해서는 **몇 가지 규칙**을 따라야 한다.

### **필드를 `final`로 선언**

모든 필드를 **`final`로 선언**하여, 한 번 초기화되면 더 이상 변경할 수 없도록 한다.

```java
public final class Person {
    private final String name;
    private final int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public int getAge() {
        return age;
    }
}
```

### **클래스를 `final`로 선언**

클래스를 **`final`로 선언**하여 **상속을 통한 수정**을 방지한다.

```java
public final class Person {
    // 클래스가 상속되지 않음
}
```

### **변경 메서드 제공 금지**

객체의 상태를 변경할 수 있는 **`setter` 메서드를 제공하지 않는다**.

```java
public class Person {
    private final String name;
    
    // setter 메서드 없음
}
```

### **참조 타입 필드의 방어적 복사**

참조 타입(예: 배열, 리스트 등)을 필드로 사용할 때, **외부에서 객체를 수정할 수 없도록 방어적 복사**를 적용한다.

```java
public final class Student {
    private final List<String> subjects;

    public Student(List<String> subjects) {
        this.subjects = new ArrayList<>(subjects); // 방어적 복사
    }

    public List<String> getSubjects() {
        return new ArrayList<>(subjects); // 방어적 복사
    }
}
```

## **불변 객체의 예시**

### **자바에서 제공하는 불변 클래스**

- **String**: 자바의 **String** 클래스는 대표적인 불변 클래스이다. `String` 객체는 한 번 생성되면 내부 값이 변경되지 않는다.
  
  ```java
  String s1 = "Hello";
  String s2 = s1.concat(" World");
  
  // s1은 여전히 "Hello"
  // s2는 "Hello World"
  ```

- **Wrapper 클래스**: 자바의 기본 타입을 감싸는 **Wrapper 클래스(Integer, Boolean, Double 등)** 또한 불변 객체이다.

  ```java
  Integer num = Integer.valueOf(5);
  // num의 값은 절대 변경되지 않음
  ```

## **불변 객체의 활용**

- **멀티스레드 환경**: 불변 객체는 멀티스레드 환경에서 **동기화 처리 없이** 안전하게 사용할 수 있다.
- **함수형 프로그래밍**: 불변 객체는 함수형 프로그래밍 패러다임에서 **상태 변화를 피하고 순수 함수를 작성**하는 데 매우 유용하다.

## **결론**

불변 객체는 **변경되지 않는 안정성** 덕분에 **안전한 공유**, **멀티스레드 환경에서의 동기화 문제 방지** 등의 장점이 있지만, **객체 생성 오버헤드** 등의 단점도 존재한다. 상황에 맞춰 불변 객체를 활용하여 **안정적이고 유지보수하기 쉬운 코드**를 작성할 수 있다.
